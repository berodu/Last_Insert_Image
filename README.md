# 동영상/이미지 → 엑셀 처리기 (Last Insert Image)

동영상과 이미지 파일을 분석하여 Excel 파일에 자동으로 삽입하는 도구입니다. 입상관 및 횡주관 배관 점검 결과를 효율적으로 문서화할 수 있습니다.

## 🚀 주요 기능

### 📹 동영상 처리
- 동영상에서 3개 프레임 자동 캡처 (시작 2초, 중간, 마지막 2초)
- 캡처된 이미지를 Excel의 '위치사진', '점검사진1', '점검사진2' 컬럼에 삽입
- 파일명에서 동, 호수, 용도 정보를 자동 추출하여 해당 행에 매칭

### 🖼️ 이미지 처리
- 이상 상황 이미지를 '이상배관사진' 컬럼에 삽입
- 파일명에서 이상유무, 위치 정보를 추출하여 해당 컬럼에 텍스트 입력
- 동, 호수, 용도 정보로 정확한 행 매칭

### 🏢 다중 단지 지원
- 동 번호에 따른 자동 단지 구분 (1단지~무한단지)
- 단지별 시트 자동 생성
- 입상관과 횡주관 별도 처리

### 🖥️ GUI 애플리케이션
- 직관적인 사용자 인터페이스
- 실시간 처리 로그 및 진행률 표시
- Excel 파일 사용 중 감지 및 경고
- 안전한 파일 처리

## 📁 파일명 패턴

### 입상관
- 동영상: `1102동 4호 입상관 세탁.mp4`
- 이미지: `1102동 4호 입상관 세탁_이물질_옥상.jpg`

### 횡주관
- 동영상: `1101동 1-1호 횡주관 배수.mp4`
- 이미지: `1101동 1-1호 횡주관 배수_이물질_옥상.jpg`

## 🛠️ 설치 방법

1. **저장소 클론**:
```bash
git clone https://github.com/yourusername/Last_Insert_Image.git
cd Last_Insert_Image
```

2. **필요한 패키지 설치**:
```bash
pip install -r requirements.txt
```

## 📖 사용 방법

### GUI 버전 (권장)
```bash
python video_excel_gui.py
```

1. Excel 파일 (sample.xlsx) 선택
2. 작업 폴더 (입상관/횡주관 포함) 선택
3. "시작" 버튼 클릭
4. 실시간 로그로 진행 상황 확인

### 커맨드라인 버전
```bash
python video_excel_processor.py
```

## 📂 프로젝트 구조

```
Last_Insert_Image/
├── video_excel_gui.py        # GUI 애플리케이션
├── video_excel_processor.py  # 핵심 처리 엔진
├── requirements.txt          # 필요한 패키지 목록
├── README.md                # 사용 설명서
├── sample.xlsx              # 샘플 Excel 템플릿
├── 입상관/                   # 입상관 파일들
│   ├── *.mp4               # 동영상 파일
│   └── *.jpg               # 이미지 파일
└── 횡주관/                   # 횡주관 파일들
    ├── *.mp4               # 동영상 파일
    └── *.jpg               # 이미지 파일
```

## ✨ 주요 특징

- **🎯 자동 매칭**: 파일명 정보로 Excel 행 자동 매칭
- **📐 이미지 최적화**: Excel에 적합한 크기로 자동 조정 (102×96px)
- **🛡️ 안전 처리**: Excel 파일 사용 중 감지 및 오류 방지
- **📊 실시간 모니터링**: 처리 과정을 실시간으로 GUI에 표시
- **🗂️ 자동 정리**: 처리 완료 후 임시 파일 자동 삭제
- **🏗️ 동적 시트 생성**: 필요에 따라 단지별 시트 자동 생성

## 🔧 기술 스택

- **Python 3.x**
- **tkinter**: GUI 프레임워크
- **OpenCV**: 동영상 프레임 캡처
- **Pillow**: 이미지 처리 및 크기 조정
- **openpyxl**: Excel 파일 읽기/쓰기
- **psutil**: 프로세스 모니터링
- **pywin32**: Windows API 접근

## ⚠️ 주의사항

- Excel 파일이 다른 프로그램에서 열려있으면 경고 메시지가 표시됩니다
- 파일명 패턴을 정확히 따라야 자동 매칭이 가능합니다
- 처리 시간은 파일 수와 크기에 따라 달라집니다
- Windows 환경에서 최적화되어 있습니다

## 📝 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다.

## 🤝 기여

버그 리포트, 기능 제안, 풀 리퀘스트를 환영합니다! 